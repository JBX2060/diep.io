## Explanation

Player tokens are JSON Web Tokens created by Rivet's API which identify you as a player. You must have one to connect to their game servers.

Their API restricts you to 5 `findLobby` or `joinLobby` related calls before showing you a captcha to "prevent bots". If you don't solve the captcha, all further requests will require a captcha too, and not solving it will also not send you back any valid player token.

## The exploit

See [the docs for the Rivet endpoint in question](https://docs.rivet.gg/docs/api/api-identity/setup-identity).

In short, make a request to the `https://identity.api.rivet.gg/v1/identities` endpoint containing an empty body like `{}`, and it will return you a new valid universal player token that you can use on any server without calling `findLobby` or `joinLobby` beforehand. This endpoint is not captcha-limited.

Example:

```js
fetch("https://identity.api.rivet.gg/v1/identities", {
  method: "POST",
  headers: {
    "Content-Type": "application/json"
  },
  body: "{}"
}).then(r => r.json()).then(r => console.log(r.identity_token.replace("game_user", "player")));
```

The returned string is ready to be used in the initial protocol packet. See [this](https://github.com/ABCxFF/diepindepth/blob/main/protocol/serverbound.md#0x00-init-packet) for more details.
